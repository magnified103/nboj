{% extends 'judge/contest_base.html' %}

{% block content %}
  <div class="content-header">
    <h1 class="text-dark">My submissions</h1>
  </div>
  <div class="content">
    <div class="row">
      <div class="col-9">
        <div class="card">
          <div class="card-body">
            <table class="table table-striped table-bordered table-hover table-sm">
              <thead>
                <tr>
                  <th class="align-middle text-center" style="width: 8%">#</th>
                  <th class="align-middle text-center" style="width: 12%">When</th>
                  <th class="align-middle" style="width: 30%">Task</th>
                  <th class="align-middle text-center" style="width: 10%">Language</th>
                  <th class="align-middle text-center" style="width: 10%">Points</th>
                  <th class="align-middle text-center" style="width: 10%">Status</th>
                  <th class="align-middle text-center" style="width: 10%">Time</th>
                  <th class="align-middle text-center" style="width: 10%">Memory</th>
                </tr>
              </thead>
              <tbody>
                  {% for submission in submissions %}
                    <tr>
                      <td class="align-middle text-center">{{ submission.id }}</td>
                      <td class="align-middle text-center">{{ submission.date | date:'M\/d\/Y H\:i\:s' }}</td>
                      <td class="align-middle"><a href="{% url 'contest_task' submission.task.contest.id submission.task.index %}">{{ submission.task.name }}</a></td>
                      <td class="align-middle text-center">{{ submission.language.name }}</td>
                      <td class="align-middle text-center">{{ submission.points | floatformat }}</td>
                      <td class="align-middle text-center">
                        <h5>
                          {% if submission.status in submission_status_processing %}
                            <div class="spinner-border" role="status">
                              <span class="sr-only">Running</span>
                            </div>
                          {% elif submission.status == 'CE' %}
                            <span class="badge badge-warning">CE</span>
                          {% elif submission.status != 'D' %}
                            <span class="badge badge-danger">IE</span>
                          {% else %}
                            {% if submission.result == 'AC' %}
                              <span class="badge badge-success">AC</span>
                            {% elif submission.result in submission_status_error %}
                              <span class="badge badge-danger">{{ submission.result }}</span>
                            {% else %}
                              <span class="badge badge-warning">{{ submission.result }}</span>
                            {% endif %}
                          {% endif %}
                        </h5>
                      </td>
                      <!-- hack from https://stackoverflow.com/a/6285428 -->
                      <td class="align-middle text-center">{% widthratio submission.time 1 1000 %} ms</td>
                      <td class="align-middle text-center">{{ submission.memory | floatformat:'0' }} KB</td>
                    </tr>
                  {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="col-3">
        <div class="card">
          <div class="card-header">
            <h1 class="card-title">{{ contest.name }}</h1>
          </div>
          <div class="progress" style="height: 2px">
            <div id="contest-progress-bar" class="progress-bar" role="progressbar" style="width: 25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
              <span class="sr-only">25%</span>
            </div>
          </div>
          <div class="card-footer">
            <p id="contest-progress-status"></p>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock %}